class Form{constructor(t){this._id=this.incrementId(),this.form=$(`#${t}`),this.formData=new FormData(this.form[0]),this.formData.append("_method",this.form.attr("method")),this.formId=t}incrementId(){this._id?this._id++:this._id=1}sendRequest(t=!1){this.clearError(),$.ajax({type:"POST",url:this.form.attr("action"),data:this.formData,async:!0,processData:!1,contentType:!1,success:function(s){if(!1===s.error)return Notification.toastMessage("Success",s.message,"success",2e3),t&&setTimeout(function(){window.location.href=s.redirect},2e3),!0},error:function(t){return Notification.toastMessage("Error",Notification.errorMessage(t),"danger",5e3),!1}})}errorMessage(t){let s=JSON.parse(t.responseText),i="";if($(".invalid-feedback").remove(),$(".is-invalid").removeClass("is-invalid"),422===t.status){i+="<ul>";let s=JSON.parse(t.responseText);$.each(s.errors,function(t,s){let e=$(`[name='${t}']`);if(e.is(":radio"))e=$(`input[name='${t}']:checked`);else{if(t.includes(".")){let[s,i]=t.split(".");e=$(`[name='${s}[${i}]']`)}else e=$(`[name='${t}']`);e||(e=$(`[name='${t}[]']`)),e.after(`<div class="invalid-feedback">${s}</div>`)}e.addClass("is-invalid"),i+=`<li>${s}</li>`}),$.each(s.success,function(t,s){let i=$(`[name='${t}']`);i.is(":radio")?i=$(`input[name='${t}']:checked`):(i||(i=$(`[name='${t}[]']`)),i.after(`<div class="valid-feedback">${s}</div>`)),i.addClass("is-valid")}),i+="</ul>"}else i+=`<ul><li>${s.message}</li></ul>`;return i}clearError(){$(".invalid-feedback").remove(),$(".is-invalid").removeClass("is-invalid")}}class Notification{constructor(t){this._id=Notification.incrementId()}static incrementId(){this._id?this._id++:this._id=1}static message(t,s,i,e=null){let a="data-autohide='false'";null===e||isNaN(e)||(a=`data-delay='${e}' data-autohide='true'`),$(".toast-dynamic").append(`<div class="toast toast-auto-${this._id}" ${a}>\n               <div class="toast-header">\n               <strong class="mr-auto text-${i}">${t}</strong>\n               <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">\n                   <span aria-hidden="true" class="close-toast">&times;</span>\n               </button>\n           </div>\n            <div class="toast-body">\n                ${s}\n            </div></div>`),$(`.toast-auto-${this._id}`).toast("show"),Notification.incrementId()}}function formAjax(t,s=!1){return new Form(t).sendRequest(s)}$(".btn-submit").on("click",function(){formAjax("form",!0)}),$(document).on("click",".click",function(){let t=$(this),s=$(this).html();$(this).html('<i class="fas fa-sync fa-2x fa-spin"></i>'),t.prop("disabled",!0),setTimeout(function(){t.prop("disabled",!1),t.html(s)},2e3)});
