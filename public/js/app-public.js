class Form{constructor(t){this._id=this.incrementId(),this.form=$(`#${t}`),this.formData=new FormData(this.form[0]),this.formData.append("_method",this.form.attr("method")),this.formData.append("_token",$('meta[name="csrf-token"]').attr("content")),this.formId=t}incrementId(){this._id?this._id++:this._id=1}sendRequest(t=!1){let e=this;e.clearError(),$.ajax({type:"POST",url:e.form.attr("action"),data:e.formData,async:!0,cache:!1,processData:!1,contentType:!1,success:function(e){return Notification.message("Success",e.message,"success",2e3),t&&setTimeout(function(){window.location.href=e.redirect},2e3),!0},error:function(t){return Notification.message("Error",e.errorMessage(t),"danger",5e3),!1}})}errorMessage(t){let e=JSON.parse(t.responseText),i="";if($(".invalid-feedback").remove(),$(".is-invalid").removeClass("is-invalid"),422===t.status){i+="<ul>";let e=JSON.parse(t.responseText);$.each(e.errors,function(t,e){let s=$(`[name='${t}']`);if(s.is(":radio"))s=$(`input[name='${t}']:checked`);else{if(t.includes(".")){let[e,i]=t.split(".");s=$(`[name='${e}[${i}]']`)}else s=$(`[name='${t}']`);s||(s=$(`[name='${t}[]']`)),s.after(`<div class="invalid-feedback">${e}</div>`)}s.addClass("is-invalid"),i+=`<li>${e}</li>`}),$.each(e.success,function(t,e){let i=$(`[name='${t}']`);i.is(":radio")?i=$(`input[name='${t}']:checked`):(i||(i=$(`[name='${t}[]']`)),i.after(`<div class="valid-feedback">${e}</div>`)),i.addClass("is-valid")}),i+="</ul>"}else i+=`<ul><li>${e.message}</li></ul>`;return i}clearError(){$(".invalid-feedback").remove(),$(".is-invalid").removeClass("is-invalid")}}class Notification{constructor(t){this._id=Notification.incrementId()}static incrementId(){this._id?this._id++:this._id=1}static message(t,e,i,s=null){let a="data-autohide='false'";null===s||isNaN(s)||(a=`data-delay='${s}' data-autohide='true'`),$(".toast-dynamic").append(`<div class="toast toast-auto-${this._id} bgo-dark" ${a}>\n               <div class="toast-header">\n               <strong class="mr-auto text-${i}">${t}</strong>\n               <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">\n                   <span aria-hidden="true" class="close-toast">&times;</span>\n               </button>\n           </div>\n            <div class="toast-body">\n                ${e}\n            </div></div>`),$(`.toast-auto-${this._id}`).toast("show"),Notification.incrementId()}}function formAjax(t,e=!1){return new Form(t).sendRequest(e)}$(".btn-submit").on("click",function(){formAjax("form",!0)}),$(document).on("click",".click",function(){let t=$(this),e=$(this).html();$(this).html('<i class="fas fa-sync fa-2x fa-spin"></i>'),t.prop("disabled",!0),setTimeout(function(){t.prop("disabled",!1),t.html(e)},2e3)}),$(".tag").tokenize2({dataSource:"/api/admin/tag",delimiter:","}),$(function(){$('[data-toggle="tooltip"]').tooltip()}),$(".close").on("click",function(){$(this).closest(".toast").remove()}),$(".btn-delete").on("click",function(){formAjax("form-delete",!0)});
